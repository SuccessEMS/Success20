<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="print" data-mc-toc-path="Configuration Guides|Skype for Business ">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="mt-type" value="application/x.deki-text" />
        <meta name="mt-unsafe" value="true" /><title>Configuring Skype for Business</title>
        <link rel="icon" href="../../Resources/Images/favicon.png" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-left is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../Home.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="How Can We Help You?" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="How Can We Help You?">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <div class="content">
                                <div id="contentBody">
                                    <div class="row collapse">
                                        <div class="topichero">
                                            <div class="title-text">
                                                <form class="search" action="#">
                                                    <div class="search-bar search-bar-container needs-pie _Skins_HomeSearchBar mc-component">
                                                        <input class="search-field needs-pie" type="search" placeholder="What can we help you find?" />
                                                        <div class="search-filter-wrapper">
                                                            <div class="search-filter">
                                                                <div class="search-filter-content">
                                                                    <ul>
                                                                        <li>All Files</li>
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="search-submit-wrapper" dir="ltr">
                                                            <div class="search-submit" title="How Can We Help You?">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="container">
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div>
                                            <div class="sideContent small-3 columns" id="smartmenu-accordion">
                                                <ul class="menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Master.js" data-mc-side-menu="True" data-mc-max-depth="-1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="False" data-mc-include-parent="False" data-mc-toc="True">
                                                </ul>
                                                <!-- <MadCap:menuProxy style="mc-toc-depth: 2;mc-context-sensitive: True;mc-include-parent: True;mc-include-siblings: False;mc-include-children: True;" data-mc-skin="/Project/Skins/SideMenu.flskn" mc-linked-toc="/Project/TOCs/SidemenuTOC.fltoc" />-->
                                            </div>
                                            <div class="small-9 columns right-content">
                                                <h1>Configure Skype for Business</h1>
                                                <p>This topic provides information on the following: </p>
                                                <ul>
                                                    <li value="1"><a href="#Prerequisites">Prerequisites</a>
                                                    </li>
                                                    <li value="2"><a href="#Deployment_Types">Deployment Types</a>
                                                    </li>
                                                    <li value="3"><a href="#Integrate_with_the_Skype_for_Business_Server">Integrate with Skype for Business Server</a>
                                                    </li>
                                                    <li value="4"><a href="#Connect_EMS_Web_App_Platform_Services">Connect EMS Web App&#160;to Platform Services</a>
                                                    </li>
                                                    <li value="5"><a href="#Configure_Skype_for_Business_on_Global_Templates">Configure Skype for Business on Global Templates</a>
                                                    </li>
                                                    <li value="6"><a href="#Configure_Skype_for_Business_on_a_Process_Template_Level">Configure Skype for Business on a Process Template Level</a>
                                                    </li>
                                                    <li value="7"><a href="#Configure_Skype_for_Business_on_Existing_Templates">Configure Skype for Business on Existing Templates</a>
                                                    </li>
                                                </ul>
                                                <p>Skype for Business must be configured in the EMS Desktop Client. The process below applies to both EMS Mobile App and EMS Web App.</p>
                                                <h2><a name="Prerequisites"></a>Prerequisites</h2>
                                                <ol>
                                                    <li value="1">Microsoft Azure Active Directory.</li>
                                                    <li value="2">User performing this task needs admin to Azure environment.</li>
                                                    <li value="3">EMS Conferencing URI (mostly to be something like this (https://servernamefqdn/web app directory/ConferencingLogin.aspx/). This URI <span class="bold">must </span>be verifiable and accessible externally.</li>
                                                </ol>
                                                <h2><a name="Deployment_Types"></a>Deployment Types</h2>
                                                <p>There are three deployment&#160;types for Skype for Business:</p>
                                                <ol class="number-list">
                                                    <li value="1"><span class="bold">On Premise</span>: This deployment for Skype for Business does not retain a token and requires authentication every 8 hours. As a result, you will be asked to sign in every 8 hours.&#160;</li>
                                                    <li value="2"><span class="bold">Online</span>: This deployment retains the token so only an initial authentication is required.&#160;</li>
                                                    <li value="3"><span class="bold">Hybrid</span>: This deployment has the same authentication method as the Online deployment.</li>
                                                </ol>
                                                <p class="title">Skype for Business Authentication and Authorization Sequence Diagram</p>
                                                <p>
                                                    <img src="../Images/Skype_CG1.png" alt="" />
                                                </p>
                                                <div>
                                                    <p class="note-box note">Note: Ensure that you have Exchange web services component deployed in your environment.&#160;</p>
                                                </div>
                                                <h2><a name="Integrate_with_the_Skype_for_Business_Server"></a>Integrate with Skype for Business Server</h2>
                                                <ol>
                                                    <li value="1">Set the authentication for Skype for Business.&#160;</li>
                                                    <li value="2">Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications tab.</li>
                                                    <li value="3">From the Area dropdown, choose Skype for Business.&#160;<p><img src="../Images/Skype_CG2.png" alt="" /></p></li>
                                                </ol>
                                                <h4>For On Premise deployment</h4>
                                                <ol start="1">
                                                    <li value="1">Set the Skype for Business Auto Discover URL parameter. This parameter performs autodiscovery&#160;to find the appropriate server to communicate with. For more information regarding setting this parameter, click see <a href="https://ucwa.skype.com/documentation/GettingStarted-RootURL" title="https://ucwa.skype.com/documentation/GettingStarted-RootURL" alt="https://ucwa.skype.com/documentation/GettingStarted-RootURL">here</a>.&#160;</li>
                                                    <li value="2">Set&#160;the Skype for Business Server Authentication Method. This parameter determines the authentication type that is used to generate a token.&#160;<ul start="1"><li value="1">The Skype for Business (On Premise) server supports three authentication methods:<ol start="1"><li value="1">ADFS (Active Directory Federation Services)&#160;(not supported in EMS Mobile App)</li><li value="2">NTLM/Windows Authentication</li><li value="3">UserName/Password</li></ol><p><img src="../Images/Skype_CG3.png" alt="" /></p></li></ul></li>
                                                </ol>
                                                <h4>For Online Deployment</h4>
                                                <ol>
                                                    <li value="1">Create a Skype for Business App in Azure AD:<ol><li value="1">Sign into the <a href="https://portal.azure.com/">Azure Management portal</a>. </li><li value="2">Select Azure Active Directory.</li><li value="3">Select App registration.</li><li value="4">Click New Application registration.</li><li value="5">Enter the required information, including:<ol><li value="1">Name of your application (e.g., EMS&#160;SFB).</li><li value="2">Application type &gt; Native.</li><li value="3">Conferencing URI (please ensure the trailing slash). </li><li value="4">Click <span class="bold">Create</span>. <br /><img src="../../Resources/Images/SkypeConfig1.png" alt="" /><br /></li></ol></li></ol></li>
                                                    <li value="2">Modify the Skype for Business App permissions:<ol><li value="1">Click on the Skype for Business App from the App Registrations.</li><li value="2">Click Required Permissions.</li><li value="3">Click Add.<br /><img src="../../Resources/Images/SkypeConfig2.png" alt="" /><br /></li><li value="4">Select all permissions for Skype for Business online.<br /><img src="../../Resources/Images/Config3.png" alt="" /><br /></li><li value="5">Select Windows Active Directory and choose only "Sign in and read user profile."<br /><img src="../../Resources/Images/SkypeConfig3.png" alt="" /><br /></li><li value="6">Click <span class="bold">Save</span>. </li></ol><p class="note-box"><span class="bold">Note</span>:&#160;From this Skype for Business application, users can add multiple URI&#160;(e.g., for testing or production URI) without creating separate Skype for Business apps for each environment.</p><ol data-mc-continue="true"><li value="7">Note the Client ID.&#160;This will need to be added to EMS&#160;parameters. <br /><img src="../../Resources/Images/SkypeConfig5.png" alt="" /><br /></li></ol><h4>Configure the Reply&#160;URL&#160;for EMS&#160;Mobile App (Skype for Business Online deployment):</h4></li>
                                                </ol>
                                                <ol>
                                                    <li value="1">Refer to the steps outlined in this <a href="https://docs.microsoft.com/en-us/azure/app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication#a-nameadvanced-aalternative-method-manually-configure-azure-active-directory-with-advanced-settings">documentation</a>.</li>
                                                    <li value="2">In the Reply URL field, insert emssoftware://skype/x.</li>
                                                </ol>
                                                <div class="note-box warning">
                                                    <p><span class="bold">Warning</span>: The cache must be cleared in Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.&#160;</p>
                                                </div>
                                                <h4>Configure the Reply URL for EMS Web App:</h4>
                                                <ol>
                                                    <li value="1">In the Reply URL field, insert the root URL:</li>
                                                    <li value="2">Skype for Business Reply URL = https://loripsor/ConferencingLogin.aspx (where EMS Web App URL = htttps://loripsor.emswebapp.com and Root URL = loripsor)</li>
                                                </ol>
                                                <p class="note-box"><span class="bold">Note</span>:&#160;When updating the EMS&#160;Web App, re-enter/reissue the secret key (from EMS&#160;Platform Services)  in the new web.config file. This hashed secret key is also stored in tbl.client. <br /><br />You may need to add https://login.microsoftonline.com and EMS&#160;Web App server in the same Internet zone. This is how Microsoft verifies and sends the token key back to EMS&#160;Web App/Platform Services server.</p>
                                                <h2><a name="Connect_EMS_Web_App_Platform_Services"></a>Connect EMS Web App&#160;to Platform Services</h2>
                                                <p>In order to integrate with Skype for Business, EMS Web App must connect to EMS Platform Services.&#160;</p>
                                                <ol>
                                                    <li value="1">Navigate to the EMS Platform Services Admin Portal.&#160;</li>
                                                    <li value="2">Select Integrations. Under Clients, click on the EMS Web App link.</li>
                                                    <li value="3">Click the Reset Secret button and copy the generated Secret.</li>
                                                    <li value="4">In the web.config file located in the designated folder for your current version of EMS, insert the copied Secret&#160;ID into the value field.&#160;</li>
                                                </ol>
                                                <p>&#160; &#160; &lt;add key="platformServicesSecret" value="YourSecretID" /&gt;</p>
                                                <div class="note-box important">
                                                    <p class="note-box.important">Important: Cloud customers do not need to generate a Secret or insert it into the web.config file (Steps 3 through 4).</p>
                                                </div>
                                                <ol start="5">
                                                    <li value="5">Clear the cache in EMS Platform Services by navigating&#160;back to the EMS Platform Services Admin Portal and clicking the Clear Cache button.&#160;</li>
                                                    <li value="6">In the EMS&#160;Desktop Client, navigate to System Administration &gt;&#160;Settings&#160;&gt;&#160;Parameters &gt;&#160;Everyday User Applications. Configure the Platform Services API&#160;URL&#160;parameter. Click Close. </li>
                                                </ol>
                                                <p>
                                                    <img src="../Images/Skype_ParamforWebApp.PNG" alt="" />
                                                </p>
                                                <h2><a name="Configure_Skype_for_Business_on_Global_Templates"></a>Configure Skype for Business on Global Templates</h2>
                                                <ol start="1">
                                                    <li value="1">Log into EMS Desktop Client.&#160;Enable the global parameters for&#160;Skype for Business within EMS. Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications tab.&#160;

    <ol start="1"><li value="1">From the Area dropdown, choose Integration to Microsoft Exchange.</li><li value="2">Select Enable Skype for Business. Click Edit.</li><li value="3">The default value is No. Set the Description to Yes.</li><li value="4">Click OK.</li><li value="5">Click Close.&#160;</li></ol></li>
                                                </ol>
                                                <p class="title">Configuring Skype for Business on a Global Template</p>
                                                <p>
                                                    <img src="../Images/Skype_CG5.png" alt="" />
                                                </p>
                                                <ol start="2">
                                                    <li value="2">Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications tab.&#160;

    <ol start="1"><li value="1">From the Area dropdown, choose System.</li><li value="2">Select Platform Services URL. Click Edit.</li><li value="3">Enter the Value (enter the URL for Platform Services) (e.g., https://serverURL/{PlatformServicesName}.</li><li value="4">Click OK.</li><li value="5">Click Close.&#160;</li></ol></li>
                                                    <ol>
                                                        <li value="1">Navigate to System Administration &gt; Settings &gt; Parameters &gt; Everyday User Applications.
    <ol start="1"><li value="1">From the Area dropdown, choose Skype for Business.</li><li value="2">Select Enable Skype for Business. Click Edit.</li><li value="3">The default value is No. Set the Description to Yes.</li><li value="4">Click OK.</li><li value="5">Click Close.&#160;</li></ol></li>
                                                    </ol>
                                                </ol>
                                                <h2><a name="Configure_Skype_for_Business_on_a_Process_Template_Level"></a>Configure Skype for Business on a Process Template Level</h2>
                                                <div class="note-box note">
                                                    <p>Note: Changing the parameters on a template level will override the global settings.</p>
                                                </div>
                                                <p>To configure Skype for Business on a process template level:</p>
                                                <ol start="1">
                                                    <li value="1">Navigate to Configuration &gt; Everyday User Applications &gt; Everyday User Process Templates.</li>
                                                    <li value="2">Click New.</li>
                                                    <li value="3">In the Everyday User Application Settings, check the <strong>Enable Integration to Microsoft Exchange</strong> box.&#160;</li>
                                                    <li value="4">Navigate to the Parameters tab.</li>
                                                    <li value="5">Filter the parameters by typing "Skype" in the Filter field.&#160;</li>
                                                    <li value="6">Click on the Enable Skype for Business parameter and click Edit. The Edit Parameter dialog box appears.</li>
                                                    <li value="7">The default value is No. Select Yes from the Enable Skype for Business dropdown. Click OK on the Edit Parameter dialog box.&#160;</li>
                                                    <li value="8">Click OK on the Everyday User Process Template box.</li>
                                                    <li value="9">Click Close.&#160;</li>
                                                </ol>
                                                <p class="title">Configuring Skype for Business on a Process Template Level</p>
                                                <p>
                                                    <img src="../Images/Skype_CG6.png" alt="" />
                                                </p>
                                                <div class="note-box warning">
                                                    <p>Warning: The cache must be cleared in Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.&#160;</p>
                                                </div>
                                                <h2><a name="Configure_Skype_for_Business_on_Existing_Templates"></a>Configure Skype for Business on Existing Templates</h2>
                                                <p>To configure Skype for Business in existing templates:</p>
                                                <ol start="1">
                                                    <li value="1">In the EMS Desktop Client, navigate to Configuration &gt; Everyday User Applications &gt; Everyday User Process Templates.</li>
                                                    <li value="2">Click on the existing template for which you want to enable Skype for Business.</li>
                                                    <li value="3">Click Edit. The template dialog box appears.&#160;</li>
                                                    <li value="4">Ensure that the&#160;Enable Integration to Microsoft Exchange box is checked in the Everyday User Application Setting section.&#160;</li>
                                                    <li value="5">Navigate to the Parameters tab.</li>
                                                    <li value="6">Filter the parameters by typing "Skype" in the Filter field.&#160;</li>
                                                    <li value="7">Click on the Enable Skype for Business parameter and click Edit. The Edit Parameter dialog box appears.
    <ol start="1"><li value="1">The default value is No. Select Yes from the Enable Skype for Business dropdown.</li><li value="2">Click OK on the Edit Parameter dialog box.&#160;</li></ol></li>
                                                    <li value="8">Click OK on the Everyday User Process Template box.</li>
                                                    <li value="9">Click Close.&#160;</li>
                                                </ol>
                                                <p class="title">Configuring Skype for Business in an Existing Template</p>
                                                <p>
                                                    <img src="../Images/Skype_CG7.png" alt="" />
                                                </p>
                                                <div class="note-box warning">
                                                    <p>Warning: The cache must be cleared in Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.</p>
                                                </div>
                                                <div class="note-box note">
                                                    <p>Note: Once a Skype meeting is added to a reservation, a&#160;Skype meeting flag—indicating that the reservation has a Skype meeting—appears in the Booking Summary tab for the reservation in the EMS Desktop Client. Additionally, the Skype ID will appear in&#160;the Properties tab for the reservation. A reservation-level display field named Skype Meeting in the Query Builder will indicate there is a Skype meeting in the reservation.</p>
                                                </div>
                                            </div>
                                            <!-- <MadCap:topicToolbarProxy style="mc-topic-toolbar-items: Back Separator Print Forward;" />-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="footer center">
                                <div class="container">
                                    <div class="HomeMasterPageFooter outer-row">
                                        <div><a href=""><a href="https://www.emssoftware.com/privacy-policy">Privacy Policy </a>|<a href="https://www.emssoftware.com/terms-of-use">Terms of Use </a>|<a href="../../ContactUs.htm"> Contact </a>|<a href="mailto:success@emssoftware.com?subject=Documentation Feedback"> Feedback</a></a>
                                            <p class="Copyright">© <span class="GeneralYear">2018</span> <span class="GeneralMy Company">EMS&#160;Software</span>, LLC. All Rights Reserved.</p>
                                        </div>
                                        <div class="footer-icons"><a href="" class="facebook"></a><a href="" class="twitter"></a><a href="" class="youtube"></a><a href="" class="linkedin"></a><a href="" class="googleplus"></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <script src="../../Resources/Scripts/sidemenu.js">
                            </script>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>