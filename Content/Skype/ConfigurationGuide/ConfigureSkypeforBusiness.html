<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title mt-export-translate="no">Configuring Skype for Business</title>
        <meta name="mt-type" value="application/x.deki-text" />
        <meta name="mt-unsafe" value="true" />
    </head>
    <body>
        <h1 MadCap:autonum="CHAPTER&#160;1: ">
            <MadCap:concept term="V44.1" />Configure Skype for Business</h1>
        <p class="box-important"><span class="bold">IMPORTANT:</span>&#160;Skype for Business can now also be configured in the <span class="bold">Conferencing </span>tab of the<a href="../../EMSPlatformServices/ConfigurationGuide/ConfigPSinAdminPortal.html#Conferencing">EMS&#160;Platform Services Admin Portal</a>. </p>
        <p>This topic provides information on the following: </p>
        <ul class="unorder-list">
            <li><a href="#SupportedSkypeProducts">Supported Skype Products</a>
            </li>
            <li><a href="#Prerequisites">Prerequisites</a>
                <ul>
                    <li><a href="#SkypeOnPremIntegration">Skype for Business Server 2015 (On-premise)&#160;Integration</a>
                    </li>
                    <li><a href="#SkypeOnline">Skype for Business Online Integration</a>
                    </li>
                </ul>
            </li>
            <li><a href="#Deployment_Types">Deployment Types</a>
            </li>
            <li><a href="#Integrate_with_the_Skype_for_Business_Server">Integrate with Skype for Business Server</a>
            </li>
            <li><a href="#Connect_EMS_Web_App_Platform_Services">Connect EMS Web App&#160;to Platform Services</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_Global_Templates">Configure Skype for Business on Global Templates</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_a_Process_Template_Level">Configure Skype for Business on a Process Template Level</a>
            </li>
            <li><a href="#Configure_Skype_for_Business_on_Existing_Templates">Configure Skype for Business on Existing Templates</a>
            </li>
        </ul>
        <h2><a name="SupportedSkypeProducts"></a>Supported Skype Products</h2>
        <ul class="unorder-list">
            <li>Skype for Business Online</li>
            <li>Skype for Business Server (On-premise) Version 2015</li>
        </ul>
        <h2><a name="Prerequisites"></a>Prerequisites</h2>
        <h3><a name="SkypeOnPremIntegration"></a>Skype for Business Server 2015 (On-premise) Integration</h3>
        <p>The following prerequisites are required for the Skype for Business Server 2015 (on-premise) integration: </p>
        <ol class="number-list">
            <li>Ensure a SHA2 and above Algorithm certificate is installed and functional. SHA2 is required as major browsers <a href="https://securityintelligence.com/news/browsers-to-end-sha-1-support-in-2017/">no longer support SHA1</a>.</li>
            <li>To provide a URL, navigate to the <a href="../../EMSPlatformServices/ConfigurationGuide/ConfigPSinAdminPortal.html#Conferencing">Platform Services Admin Page <span class="bold">Conferencing </span>tab</a>. If a URL is not provided, EMS will build a URL based on the Everyday User's email address.</li>
        </ol>
        <div class="box-note">
            <p><a name="AutodiscoverURL"></a><span class="bold">NOTES:</span>&#160;Optionally, you can provide one or more URLs. Multiple URLs must be separated by commas and contain no spaces.</p>
            <p>Ensure you can access the URL without certificate errors (EMS&#160;Software recommends using the Google Chrome browser). AutoDiscover URL should return an xml file. If you experience certificate errors, please refer to the first step above. </p>
        </div>
        <ol class="number-list" MadCap:continue="true">
            <li>Ensure all EMS components have been <MadCap:annotation MadCap:createDate="2018-08-21T09:20:30.7064314-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Deployed without Skype for Business, right? Then they deploy again with the SfB integration (later section)?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:20:39.8152231-06:00">deployed</MadCap:annotation>:<ol style="list-style-type: lower-alpha;"><li>EMS Platform Services</li><li><MadCap:annotation MadCap:createDate="2018-08-21T09:04:13.2628284-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Why are Mobile, DTC, and IME listed as sub-bullets under Web App? Is there an order to deployment that needs to be followed?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:05:35.3570471-06:00">EMS</MadCap:annotation> Web App (optional)<ol style="list-style-type: lower-roman;"><li><MadCap:variable name="General.Mobile" /> (optional)</li><li><MadCap:variable name="General.EMS&#160;Desktop Client" /></li><li>Integration to Microsoft Exchange</li></ol></li></ol></li>
        </ol>
        <h3><a name="SkypeOnline"></a>Skype for Business Online Integration</h3>
        <p>The following prerequisites are required for the Skype for Business online integration: </p>
        <ol class="number-list">
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T09:09:11.0948118-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Do they need to do anything wiht AAD or just have it installed? Maybe write (similar to Step 1 in on-premise): &quot;Ensure Microsoft Azure Active Directory is installed and functional.&quot; " MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:16:50.0154354-06:00">Microsoft</MadCap:annotation> Azure Active Directory.</li>
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T09:17:19.1458136-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="&quot;Ensure you have access to the Azure environment&quot;?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:18:05.8771456-06:00">Admin </MadCap:annotation>access to Azure environment. </li>
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T09:18:35.5552111-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Provide the URI, create a URI...what do they do with the URI?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:19:10.2224310-06:00">EMS Conferencing URI</MadCap:annotation> (mostly to be something like this (https://servernamefqdn/web app directory/ConferencingLogin.aspx/). This URI <span class="bold">must </span>be verifiable and accessible externally.</li>
            <li>Ensure all <MadCap:annotation MadCap:createDate="2018-08-21T09:19:31.0260168-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Deployed without Skype for Business, right? Then they deploy again with the SfB integration (next section)?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:20:19.5428167-06:00">EMS&#160;components have been deployed</MadCap:annotation>:<ol style="list-style-type: lower-alpha;"><li>EMS Platform Services</li><li><MadCap:annotation MadCap:createDate="2018-08-21T09:11:08.0503018-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Why are Mobile, DTC, and IME listed as sub-bullets under Web App? Is there an order to deployment that needs to be followed?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:11:08.5829987-06:00">EMS</MadCap:annotation>&#160;Web App (optional)<ol style="list-style-type: lower-roman;"><li><MadCap:variable name="General.Mobile" /> (optional)</li><li><MadCap:variable name="General.EMS&#160;Desktop Client" /></li><li>Integration to Microsoft Exchange</li></ol></li></ol></li>
        </ol>
        <h2><a name="Deployment_Types"></a>
            <MadCap:annotation MadCap:createDate="2018-08-21T09:21:36.1000284-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Do these deployment types go with the prerequisites above? Maybe put the deployment types with their prerequisites (or put this section before the prerequisites). Users should first determine which type of deployment to use and then ensure the prerequisites are met." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:24:10.3438044-06:00">Deployment Types</MadCap:annotation>
        </h2>
        <p>There are three deployment&#160;types for Skype for Business:</p>
        <ol class="number-list">
            <li><span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T09:27:22.4240961-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="At end of this numbered item, add link to prerequisites and link to deployment instructions." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:28:05.6629951-06:00">Skype</MadCap:annotation> for Business Server 2015 On Premise:</span> This deployment for Skype for Business does not retain a token and requires authentication every 8 hours. As a result, you will be asked to sign in every 8 hours.&#160;</li>
            <li><span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T09:28:13.4855361-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="At end of this numbered item, add link to prerequisites and link to deployment instructions." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:28:14.1351668-06:00">Skype</MadCap:annotation> for Business Online:</span> This deployment retains the token so only an initial authentication is required.&#160;</li>
            <li><span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T09:28:16.3039306-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="At end of this numbered item, add link to prerequisites and link to deployment instructions." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:28:17.0684949-06:00">Hybrid</MadCap:annotation>:</span> This deployment has the same authentication method as the Online deployment. Please follow the Skype for Business Online Integration steps for configuration. </li>
        </ol>
        <p class="box-note"><span class="bold">NOTE:</span>&#160;EMS&#160;Software uses Unified Communications Web API&#160;2.0 to integrate with Skype for Business Server and Skype for Business Online. </p>
        <div class="TitleandImage">
            <p class="title">Skype for Business Authentication and Authorization Sequence Diagram</p>
            <p>
                <img class="PDFlarge" src="../Images/Skype_CG1.png" />
            </p>
        </div>
        <div class="box-important">
            <p><span class="boldAllCaps">Important:</span> Ensure that you have <MadCap:annotation MadCap:createDate="2018-08-21T09:34:06.9075696-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Is this EWIS through EMS? If so, add link to install/update EWIS topic." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:38:32.9353928-06:00">Exchange Web services</MadCap:annotation> component deployed in your environment.&#160;</p>
        </div>
        <h2><a name="Integrate_with_the_Skype_for_Business_Server"></a>
            <MadCap:annotation MadCap:createDate="2018-08-21T10:04:29.8690227-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Is part of this section obsolete? In U24, all Skype parameters moved to Platform, so should this section be re-written with that info? Should step 1 be done in the Platform Admin portal. What about step 2? Has the Platform Services API URL moved?\r\n\r\nIf this section is still necessary, do all deployment methods do this? Is this done before, during, or after the deployment methods listed above?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T10:52:19.3948478-06:00">Integrate with Skype for Business Server</MadCap:annotation>
        </h2>
        <ol class="number-list">
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T09:39:33.7666964-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="By completing steps 2 and 3, or is there another place to set the authentication?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T09:40:18.1909326-06:00">From the EMS&#160;Desktop Client, set the authentication for Skype for Business as follows: </MadCap:annotation>
                <ol>
                    <li>Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab and select <span class="bold">Skype for Business</span> from the Area dropdown.<div class="TitleandImage"><p class="title">Everyday User Applications Tab, Skype for Business</p><p><img class="PDFlarge" src="../Images/Skype_CG2.png" style="width: 561px;height: 289px;" /></p></div></li>
                    <li>Select the <span class="bold">Skype for Business Auto Discover URL</span> parameter and click <span class="bold">Edit </span>to specify the AutoDiscover URL. This parameter performs autodiscovery&#160;to find the appropriate server to communicate with. The client machine and the Web server should have access to the AutoDiscover URL.</li>
                    <li>Select the <span class="bold">Skype for Business Server Authentication Method</span> parameter and click <span class="bold">Edit </span> to specify the authentication type that is used to generate a token.&#160;The Skype for Business (On Premise) server supports three authentication methods:<ul><li><span class="bold">ADFS</span> (Active Directory Federation Services)&#160;(not supported in EMS Mobile App)</li><li><span class="bold">NTLM</span> (Windows Authentication)</li><li><span class="bold">UserName/Password</span></li></ul><div class="TitleandImage"><p class="title">Parameter Dialog</p><p><img class="PDFlarge" src="../Images/Skype_CG3.png" /></p></div></li>
                </ol>
            </li>
        </ol>
        <ol MadCap:continue="true" class="number-list">
            <li>From the <span class="bold">Everyday User Applications</span> parameters tab, <MadCap:annotation MadCap:createDate="2018-08-21T10:55:24.1888097-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Has this parameter been taken out of DTC and moved to Platform Admin Portal? Can't find the parameter in the launcher DTC." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T10:55:56.9110240-06:00">select the <span class="bold">Platform Services API URL</span> parameter</MadCap:annotation> and click <span class="bold">Edit </span>to specify the Platform Services URL.</li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Everyday User Applications Tab, Platform Services API&#160;URL</p>
            <p>
                <img src="../../EMSRoomSignApp/44.1/Images/image11.png" class="PDFlarge" />
            </p>
        </div>
        <ol MadCap:continue="true" class="number-list">
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T10:34:20.7273681-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Where do they do this?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T10:34:43.9310713-06:00">Add EMS Applications to the Allowed Domains List.</MadCap:annotation> Unified Communications Web API (UCWA) uses xframe and cross-domain scripting to accomplish the user authentication to leverage the integration. Therefore, EMS applications must be added to a whitelist within the Skype for Business implementation. The whitelist needs to be updated on each of the servers that a user could leverage. For more information, please see <a href="https://ucwa.skype.com/documentation/itadmin-configuration">here</a>. <ul MadCap:continue="true"><li>At a minimum, customers will need to whitelist the EMS&#160;Web App and EMS&#160;Mobile App conferencing URL (trailing forward slash is required). Please see examples below:<ul><li>EMS&#160;Web App: https://servername.domain/EMSWebApplicationName/ConfrencingLogin.aspx/<ul><li>Any combination of this URL will need to be whitelisted (e.g., if there is a different URL for Internal versus External or Mobile Web Access).</li></ul></li><li>EMS&#160;Mobile App: <br />emssoftware://skype/x<ul><li>If the customer re-Packages the EMS&#160;Mobile App, the same URL should be used.</li></ul></li></ul></li><li>Optionally, whitelisting the EMS Web server will facilitate both test and prod environments without adding multiple single entries. Please consult your organization's IT&#160;department and provide them <MadCap:annotation MadCap:createDate="2018-08-21T09:55:44.8155517-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Are the steps in this topic or in the following note? Info from &quot;steps&quot; link is informaional and not steps. Is the link correct? " MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T10:46:17.9043426-06:00">with the following <a href="https://ucwa.skype.com/documentation/itadmin-configuration">steps</a></MadCap:annotation>. </li></ul></li>
        </ol>
        <div class="box-important">
            <p><span class="boldAllCaps">Important:</span> When testing the Skype for Business Integration, ensure you are using a whitelisted <span class="bold">FULLY QUALIFIED DOMAIN</span>. Most browsers will throw a cross domain error unless the server name is whitelisted without FDQN.</p>
            <p>For example: <span class="bold">http://xxxx.servername.com/emswebapp </span>is different than <span class="bold">http://xxxx/emswebapp </span><br />or <span class="bold">https://xxxxx.servername.com/emswebapp</span></p>
        </div>
        <ol start="8" class="number-list">
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T10:48:17.9531398-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="What do they do here: &quot;Configure trusted Skype certificates&quot;?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T10:50:04.9738216-06:00">Skype certificates.</MadCap:annotation> The client devices and EMS Servers need to be able to trust the certificates that are installed on the Skype servers within the Skype implementation. Customers can use private certificates that the Web server has been configured to trust.</li>
        </ol>
        <h3>Integration with Skype for Business Online</h3>
        <ol class="number-list">
            <li>Create a Skype for Business App in Azure AD:<ol><li>Sign into the <a href="https://portal.azure.com/">Azure Management portal</a>.</li><li><MadCap:annotation MadCap:createDate="2018-08-21T11:43:47.7280633-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Set it to what? Maybe &quot;Select the active directory you want to integrate with Skype for Business&quot;?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T11:45:32.9766624-06:00"> Set the Azure Active Directory</MadCap:annotation>.</li><li>Select <span class="bold">App registration</span>. </li><li>Click <span class="bold">New application registration</span>.</li><li>Enter the required information, including:<ol style="list-style-type: lower-roman;"><li>In the Name field, enter the name of your application (e.g., EMS SFB).</li><li>In the Application type field, select <span class="bold">Native</span>.</li><li>In the Redirect URI field, enter the Conferencing URI (make sure to include the trailing slash).</li><li>Click <span class="bold">Create</span>.</li></ol></li></ol></li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Creating a Skype for Business App in Microsoft Azure</p>
            <p>
                <img class="PDFlarge" src="../../Resources/Images/SkypeConfig1.png" />
            </p>
        </div>
        <ol class="number-list" MadCap:continue="true">
            <li>Modify the Skype for Business App permissions as follows:<ol><li>Click on the Skype for Business App from the App Registrations.</li><li>Click <span class="bold">Required Permissions</span>.</li><li>Click <span class="bold">Add</span>.<br /><img src="../../Resources/Images/SkypeConfig2.png" class="PDFlarge" /><br /></li><li>Select all permissions for Skype for Business online.<br /><img src="../../Resources/Images/Config3.png" class="PDFmedium" /><br /></li><li>Select Windows Active Directory and choose only <span class="bold">Sign in and read user profile</span>.<br /><img src="../../Resources/Images/SkypeConfig3.png" class="PDFmedium" /><br /></li><li>Click <span class="bold">Save</span>. </li></ol><div class="box-note"><p><span class="boldAllCaps">Note:</span>&#160;From this Skype for Business application, users can add multiple URI&#160;(e.g., for testing or production URI) without creating separate Skype for Business apps for each environment.</p></div><ol start="7"><li>Note the Client ID.&#160;This will need to be added to EMS&#160;parameters. <br /><img class="PDFlarge" src="../../Resources/Images/SkypeConfig5.png" /><br /></li></ol></li>
            <li>From the EMS&#160;Desktop Client, set the authentication for Skype for Business as follows: <ol MadCap:continue="true"><li>Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab and select <span class="bold">Skype for Business</span> from the Area dropdown.</li><li>Select the <span class="bold">Azure Active Directory Client ID</span> parameter and click <span class="bold">Edit </span>to specify the ID of the registered application. For more information regarding setting this parameter, click <a href="https://msdn.microsoft.com/en-us/skype/ucwa/registeringyourapplicationinazuread">here</a>. Please refer to the above steps to create Client ID.</li><li>Select the <span class="bold">Azure Active Directory Tenant</span> parameter and click <span class="bold">Edit </span>to specify the name of the AAD tenant. For more information regarding setting this parameter, click <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-howto-tenant">here</a>.</li><li>Select the <span class="bold">Skype for Business Auto Discover URL</span> parameter and click <span class="bold">Edit </span>to specify the AutoDiscover URL. This parameter performs autodiscovery&#160;to find the appropriate server to communicate with. For more information regarding setting this parameter, click <a href="https://msdn.microsoft.com/en-us/skype/ucwa/authenticationusingazuread">here</a>. The client machine and the Web server should have access to the AutoDiscover URL.</li><li>Select the <span class="bold">Skype for Business Server Authentication Method</span> parameter and click <span class="bold">Edit </span> to specify the authentication type that is used to generate a token.&#160;The Skype for Business (Online) only supports the <span class="bold">Oauth </span>authentication method:<br /><img src="../../EMSRoomSignApp/44.1/Images/image12.png" class="PDFmedium" /></li></ol></li>
            <li>Configure the Reply&#160;URL in EMS&#160;Mobile App and EMS&#160;Web App as follows:</li>
            <ul>
                <li>&#160;EMS&#160;Mobile App:<ol style="list-style-type: lower-alpha;"><li>Refer to the steps outlined in this <a href="https://docs.microsoft.com/en-us/azure/app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication#a-nameadvanced-aalternative-method-manually-configure-azure-active-directory-with-advanced-settings">documentation</a>.</li><li>In the Reply URL field, insert emssoftware://skype/x.</li></ol><div class="box-warning"><p><span class="boldAllCaps"><MadCap:annotation MadCap:createDate="2018-08-21T12:14:52.3095286-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Should this warning be here or by step 3 where parameter changes were made or in both places?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:15:18.0258991-06:00">Warning</MadCap:annotation>:</span> The cache must be cleared in EMS&#160;Platform Services&#160;and EMS Web App whenever parameter changes are made in the EMS Desktop Client.&#160;</p></div></li>
                <ul MadCap:continue="true">
                    <li>EMS Web App:<ul><li><MadCap:annotation MadCap:createDate="2018-08-21T12:16:08.2642746-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="How do they get to the reply field? Where do they insert the root URL? Should they use the same steps outlined in the linked do that Mobile App used? Is this done in the PS Admin Portal? " MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:19:00.4741049-06:00">In the Reply URL field, insert the root URL:</MadCap:annotation><ul><li>Skype for Business Reply URL = https://loripsor/ConferencingLogin.aspx (where EMS Web App URL = htttps://loripsor.emswebapp.com and Root URL = loripsor)</li></ul></li></ul></li>
                </ul>
            </ul>
        </ol>
        <p class="box-note"><span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T12:25:24.0898876-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Are the instructions for reissuing the secret key in the next section &quot;Connect Web App to Platform&quot; in steps 1-5?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:26:57.4029923-06:00">NOTE</MadCap:annotation>:</span>&#160;When updating the EMS Web App, re-enter/reissue the secret key (from EMS Platform Services) in the new web.config file.  You may need to add https://login.microsoftonline.com and EMS Web App server in the same Internet zone. This is how Microsoft verifies and sends the token key back to EMS Web App/Platform Services server.</p>
        <h2><a name="Connect_EMS_Web_App_Platform_Services"></a>
            <MadCap:annotation MadCap:createDate="2018-08-21T12:19:13.8045082-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Does this need to be done prior to the configuring the reply URL from step 4 in the section above? The note after step 4 discusses Web App and Platform services." MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:20:26.9244752-06:00">Connect EMS Web App&#160;to Platform Services</MadCap:annotation>
        </h2>
        <p>To integrate with Skype for Business, EMS Web App must connect to EMS Platform Services.&#160;</p>
        <ol class="number-list">
            <li>Navigate to the EMS Platform Services Admin Portal.&#160;</li>
            <li>Select <span class="bold">Integrations</span>. Under Clients, click on the EMS Web App link.</li>
            <li>Click the <span class="bold">Reset Secret</span> button and copy the generated Secret.</li>
            <li>In the web.config file located in the designated folder for your current version of EMS, insert the copied Secret&#160;ID into the value field.&#160;</li>
        </ol>
        <div class="indent"><pre>&#160; &#160; &lt;add key="platformServicesSecret" value="YourSecretID" /&gt;</pre>
        </div>
        <div class="box-important">
            <p><span class="boldAllCaps">IMPORTANT:</span> EMS Cloud Services customers do not need to generate a Secret or insert it into the web.config file (Steps 3 through 4).</p>
        </div>
        <ol start="5" class="number-list">
            <li>Clear the cache in EMS Platform Services by navigating&#160;back to the EMS Platform Services Admin Portal and <MadCap:annotation MadCap:createDate="2018-08-21T12:23:14.0381138-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Does the Web App cache also need to be cleared after the change to the web.config file?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:23:41.6253735-06:00">clicking the <span class="bold">Clear Cache</span> button</MadCap:annotation>.&#160;</li>
            <li>In the EMS&#160;Desktop Client, navigate to <span class="bold">System Administration</span> &gt;&#160;<span class="bold">Settings&#160;</span>&gt;&#160;<span class="bold">Parameters </span>&gt;&#160;<span class="bold">Everyday User Applications</span>. <MadCap:annotation MadCap:createDate="2018-08-21T12:49:46.6668999-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Can't find parameter in launcher version of DTC. Has this parameter been moved?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:50:10.7810947-06:00">Configure the <span class="bold">Platform Services API&#160;URL</span>&#160;parameter. Click <span class="bold">Close</span>.</MadCap:annotation> </li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Everyday User Applications Tab, Platform Services API&#160;URL</p>
            <p>
                <img src="../Images/Skype_ParamforWebApp.PNG" class="PDFlarge" />
            </p>
        </div>
        <h2><a name="Configure_Skype_for_Business_on_Global_Templates"></a>Configure Skype for Business on Global Templates</h2>
        <p class="box-important"><span class="boldAllCaps">IMPORTANT:</span>&#160;Skype for Business can now be configured on the <a href="../../EMSPlatformServices/ConfigurationGuide/ConfigPSinAdminPortal.html#Conferencing">EMS&#160;Platform Services Admin UI</a>. </p>
        <ol start="1" class="number-list">
            <li>Log into EMS Desktop Client or the <MadCap:annotation MadCap:createDate="2018-08-21T12:55:16.7279644-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Should we add steps for doing this in the PS Admin Portal?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:55:33.9551059-06:00">EMS&#160;Platform Services Admin UI </MadCap:annotation>to enable the global parameters for&#160;Skype for Business. </li>
            <li>In the EMS&#160;Desktop Client, navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab.&#160;<ol start="1"><li>From the Area dropdown, choose <span class="bold">Integration to Microsoft Exchange</span>.</li><li>Select <span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T12:43:36.7483999-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Is this parameter still in DTC or can it only be configured through the PS Admin Portal?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:44:17.0993042-06:00">Enable Skype for Business</MadCap:annotation></span>. Click <span class="bold">Edit</span>.</li><li>The default value is No. Set the Description to <span class="bold">Yes</span>.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Configuring Skype for Business on a Global Template</p>
            <p>
                <img src="../Images/Skype_CG5.png" class="PDFlarge" />
            </p>
        </div>
        <ol start="2" class="number-list">
            <li>Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings</span> &gt; <span class="bold">Parameters</span> &gt; <span class="bold">Everyday User Applications</span> tab.&#160;<ol start="1"><li>From the Area dropdown, choose <span class="bold">System</span>.</li><li><MadCap:annotation MadCap:createDate="2018-08-21T12:49:12.7507472-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Can't find parameter in my launcher version of DTC? Has this parameter been moved or is launcher out of date?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T12:49:37.4904164-06:00">Select <span class="bold">Platform Services URL</span>.</MadCap:annotation> Click <span class="bold">Edit</span>.</li><li>Enter the URL for Platform Services. For example:&#160;https://serverURL/{PlatformServicesName}.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
            <li>
                Navigate to <span class="bold">System Administration</span> &gt; <span class="bold">Settings </span>&gt; <span class="bold">Parameters </span>&gt; <span class="bold">Everyday User Applications</span> tab.
    <ol start="1" MadCap:continue="true"><li>From the Area dropdown, choose <span class="bold">Skype for Business</span>.</li><li>Select <span class="bold">Enable Skype for Business</span>. Click <span class="bold">Edit</span>.</li><li>The default value is No. Set the Description to <span class="bold">Yes</span>.</li><li>Click <span class="bold">OK</span>.</li><li>Click <span class="bold">Close</span>.&#160;</li></ol></li>
            <li>
                <p>In <MadCap:annotation MadCap:createDate="2018-08-21T12:55:49.4422377-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="How is this done globally? How do you get to a global &quot;everday user application settings tab&quot;? Configuration &gt; Everyday User Applications &gt; Everyday User Process Templates &gt; Select Template and click Edit &gt; Process Template tab?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:06:30.3714173-06:00">the Everyday User Application Settings</MadCap:annotation>, check the <span class="bold">Enable Integration to Microsoft Exchange</span> box.</p>
            </li>
        </ol>
        <h2><a name="Configure_Skype_for_Business_on_a_Process_Template_Level"></a>Configure Skype for Business on a Process Template Level</h2>
        <div class="box-note">
            <p><span class="boldAllCaps">NOTE:</span> Changing the parameters on a template level will override the global settings.</p>
        </div>
        <ol start="1" class="number-list">
            <li>In the EMS Desktop Client, navigate to <span class="bold">Configuration</span> &gt; <span class="bold">Everyday User Applications</span> &gt; <span class="bold">Everyday User Process Templates</span>.</li>
            <li>Click <span class="bold"><MadCap:annotation MadCap:createDate="2018-08-21T13:21:55.3683136-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Does it have to be a New template. Could an existing template be edited to include IME and Skype? The next section is about editing existing templates. Can we just put a not or bullet at step 2 and mention Edit button instead of having two sections with almost identical steps?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:44:34.9896246-06:00">New</MadCap:annotation></span>. The template dialog box appears.</li>
        </ol>
        <p class="box-note"><span class="boldAllCaps">Note:</span>&#160;To edit an existing template, see <a href="#Configure_Skype_for_Business_on_Existing_Templates">Configure Skype for Business on Existing Templates</a>.</p>
        <ol start="1" class="number-list" MadCap:continue="true">
            <li>In the Everyday User Application Settings section of the <span class="bold">Process Templates</span> tab, check the <strong>Enable Integration to Microsoft Exchange</strong> box.&#160;</li>
            <li>Navigate to the <span class="bold">Parameters</span> tab.</li>
            <li>
                <MadCap:annotation MadCap:createDate="2018-08-21T13:10:39.5775678-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="If Skype parameters have moved, is this done in the PS Admin Portal? If so, how is it done (at what point in this process)?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:55:37.5670756-06:00">Filter the parameters by typing "Skype" in the Filter field.</MadCap:annotation>
            </li>
            <li>Click on the <span class="bold">Enable Skype for Business </span>parameter and click <span class="bold">Edit</span>. The Edit Parameter dialog box appears.<ol start="1" MadCap:continue="true" style="list-style-type: lower-alpha;"><li>The default value is No. Select <span class="bold">Yes</span> from the Enable Skype for Business dropdown. </li><li>Click <span class="bold">OK</span> on the Edit Parameter dialog box.&#160;</li></ol></li>
            <li>Click <span class="bold">OK</span> on the Everyday User Process Template box.</li>
            <li>Click <span class="bold">Close</span>.&#160;</li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Configuring Skype for Business on a Process Template Level</p>
            <p>
                <img src="../Images/Skype_CG6.png" class="PDFmedium" />
            </p>
        </div>
        <div class="box-warning">
            <p><span class="boldAllCaps">WARNING:</span> The cache must be cleared in <MadCap:annotation MadCap:createDate="2018-08-21T13:24:31.8745906-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Link to instructions for this? Where is the topic for the Web App Admin Functions screen. I can't find it when I search. I wanted to link to instructions on Clearing Cache in the Web App. Should we create a topic like that some day if one doesn't exist?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:36:00.5999031-06:00"><a href="../../EMSPlatformServices/ConfigurationGuide/ConfigPSinAdminPortal.html#ClearCache">EMS&#160;Platform Services</a>&#160;and EMS Web App</MadCap:annotation> whenever parameter changes are made in the EMS Desktop Client.&#160;</p>
        </div>
        <h2><a name="Configure_Skype_for_Business_on_Existing_Templates"></a>Configure Skype for Business on Existing Templates</h2>
        <p>To configure Skype for Business in existing templates:</p>
        <ol start="1" class="number-list">
            <li>In the EMS Desktop Client, navigate to <span class="bold">Configuration</span> &gt; <span class="bold">Everyday User Applications</span> &gt; <span class="bold">Everyday User Process Templates</span>.</li>
            <li>Click on the existing template for which you want to enable Skype for Business.</li>
            <li>Click <span class="bold">Edit</span>. The template dialog box appears.&#160;</li>
            <li>Ensure that the&#160;<span class="bold">Enable Integration to Microsoft Exchange</span> box is checked in the Everyday User Application Settings section of the <span class="bold">Process Templates</span> tab.&#160;</li>
            <li>Navigate to the <span class="bold">Parameters</span> tab.</li>
            <li>Filter the parameters by typing "Skype" in the Filter field.&#160;</li>
            <li>Click on <MadCap:annotation MadCap:createDate="2018-08-21T13:52:41.6987450-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Has this parameter been removed from DTC? If so, how is this part done in the PS Admin portal? Does the user make sure &quot;Enable Integratio nto Microsoft Exchange&quot; box is checked and then configure settings in PS Admin Portal?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:53:50.9680944-06:00">the <span class="bold">Enable Skype for Business</span> parameter</MadCap:annotation> and click <span class="bold">Edit</span>. The Edit Parameter dialog box appears.<ol start="1"><li>The default value is No. Select <span class="bold">Yes </span>from the Enable Skype for Business dropdown.</li><li>Click <span class="bold">OK</span> on the Edit Parameter dialog box.&#160;</li></ol></li>
            <li>Click <span class="bold">OK</span> on the Everyday User Process Template box.</li>
            <li>Click <span class="bold">Close</span>.&#160;</li>
        </ol>
        <div class="TitleandImage">
            <p class="title">Configuring Skype for Business in an Existing Template</p>
            <p>
                <img src="../Images/Skype_CG7.png" class="PDFmedium" />
            </p>
        </div>
        <div class="box-warning">
            <p><span class="boldAllCaps"><MadCap:annotation MadCap:createDate="2018-08-21T13:55:55.3918724-06:00" MadCap:creator="Megan.Laub" MadCap:initials="ME" MadCap:comment="Should this warning be a snippet? Can we link to the clear cache instructions for all these warnings?" MadCap:editor="Megan.Laub" MadCap:editDate="2018-08-21T13:56:21.3350240-06:00">WARNING:</MadCap:annotation></span> The cache must be cleared in EMS Platform Services&#160;and the EMS Web App whenever parameter changes are made in the EMS Desktop Client.</p>
        </div>
        <div class="box-note">
            <p><span class="boldAllCaps">NOTE:</span> Once a Skype meeting is added to a reservation, a&#160;Skype meeting flag, which indicates that the reservation has a Skype meeting, appears in the <span class="bold">Booking Summary</span> tab for the reservation in the EMS Desktop Client. Additionally, the Skype ID will appear in&#160;the <span class="bold">Properties </span>tab for the reservation. A reservation-level display field named <span class="bold">Skype Meeting</span> in the Query Builder will indicate there is a Skype meeting in the reservation.</p>
        </div>
    </body>
</html>